<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</title>
<style>
    body { font-family:Cairo; background:#eef1f5; padding:20px; }
    .panel, .loginBox { 
        max-width:900px; margin:auto; background:white; padding:25px;
        border-radius:15px; box-shadow:0 5px 20px rgba(0,0,0,0.1); 
    }
    .note { background:#fff; padding:15px; border-radius:10px;
            border-right:5px solid #f59e0b; margin:10px 0; cursor:pointer; }
    .replyBox { margin-top:30px; background:#fff; padding:20px; border-radius:10px; }
    input { width:100%; padding:12px; border-radius:10px; border:1px solid #ddd; margin:10px 0; }
    button { padding:12px; border:none; border-radius:10px; cursor:pointer; font-size:16px; }
</style>
</head>

<body>

<!-- ØµÙ†Ø¯ÙˆÙ‚ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ -->
<div id="loginBox" class="loginBox">
    <h2 style="text-align:center;color:#2563eb;">ğŸ” ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h2>

    <input id="pass" type="password" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±">

    <button onclick="login()" 
        style="background:#2563eb;color:white;width:100%;margin-top:10px;">
        Ø¯Ø®ÙˆÙ„
    </button>

    <p id="loginStatus" style="color:red;text-align:center;margin-top:10px;"></p>
</div>

<!-- Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© -->
<div id="panel" class="panel" style="display:none;">
    <h2 style="color:#2563eb;text-align:center;">âš™ï¸ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</h2>

    <div id="notesList"></div>

    <div class="replyBox">
        <h3>ğŸ”„ Ø§Ù„Ø±Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø©</h3>
        <textarea id="reply" rows="3" placeholder="Ø§ÙƒØªØ¨ Ø§Ù„Ø±Ø¯ Ù‡Ù†Ø§..."></textarea>
        <br><br>
        <button onclick="sendReply()" 
                style="padding:12px;background:#10b981;color:white;border:none;border-radius:10px;">
            Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø¯
        </button>
    </div>
</div>

<script>
const scriptURL = "https://script.google.com/macros/s/AKfycbzI1WkE0fUr6HaYiNMBiDn9JfTIByXjCvjQ6jnTyasz5Asyn0mLX4dNrcLVFADVHKMr/exec";
const correctPassword = "aysha123";  // ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± Ù‡Ù†Ø§ ÙÙ‚Ø·

let selectedRow = null;

/************** ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ **************/
function login() {
    const pass = document.getElementById("pass").value;

    if (pass === correctPassword) {
        document.getElementById("loginBox").style.display = "none";
        document.getElementById("panel").style.display = "block";
        loadNotes();
    } else {
        document.getElementById("loginStatus").innerHTML = "âŒ ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± ØºÙŠØ± ØµØ­ÙŠØ­Ø©";
    }
}

/************** ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª **************/
async function loadNotes() {
    const res = await fetch(scriptURL, {
        method:"POST",
        body:JSON.stringify({ type:"get" })
    });

    const data = await res.json();
    const list = document.getElementById("notesList");
    list.innerHTML = "";

    data.data.forEach(n=>{
        list.innerHTML += `
            <div class="note" onclick="select(${n.row})">
                <b>${n.name}</b> - <i>${n.status}</i><br>
                ${n.note}
            </div>
        `;
    });
}

function select(row) {
    selectedRow = row;
    alert("ØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø© Ø±Ù‚Ù…: " + row);
}

/************** Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø¯ **************/
async function sendReply() {
    if (!selectedRow) return alert("Ø§Ø®ØªØ± Ù…Ù„Ø§Ø­Ø¸Ø© Ø£ÙˆÙ„Ø§Ù‹");

    const reply = document.getElementById("reply").value;

    await fetch(scriptURL, {
        method:"POST",
        body:JSON.stringify({ type:"reply", row:selectedRow, reply })
    });

    alert("ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø¯");
    loadNotes();
}
</script>

</body>
</html>
