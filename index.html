<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Ù‚Ù†Ø§Ø© Ø§Ù„Ø£Ø³ØªØ§Ø° Ø®Ù„ÙŠÙ„ Ø§Ù„Ø¨Ù„ÙˆØ´ÙŠ â€“ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª</title>

<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet">

<style>
:root {
  --bg:#f2f4f7;
  --header:#2563eb;
  --header-dark:#1e40af;
  --text:#1e293b;
  --bubble:#ffffff;
  --bubble-shadow:rgba(0,0,0,0.07);
}

body {
  margin:0;
  background:var(--bg);
  font-family:"Cairo",sans-serif;
  color:var(--text);
}

.app-header {
  position:sticky;
  top:0;
  background:var(--header);
  padding:18px;
  text-align:center;
  font-size:22px;
  font-weight:700;
  color:white;
  box-shadow:0 2px 12px rgba(0,0,0,0.2);
  z-index:99;
}

.container {
  max-width:520px;
  margin:0 auto;
  padding:14px;
}

.input-card {
  background:var(--bubble);
  padding:18px;
  border-radius:14px;
  box-shadow:0 3px 10px var(--bubble-shadow);
}

input, textarea {
  width:100%;
  padding:12px;
  margin:8px 0;
  border-radius:10px;
  border:1px solid #cbd5e1;
  font-size:16px;
  background:#f8fafc;
}

.send-btn {
  width:100%;
  padding:13px;
  background:#2563eb;
  color:white;
  border:none;
  border-radius:12px;
  font-size:18px;
  font-weight:600;
  cursor:pointer;
}

.note {
  background:var(--bubble);
  padding:18px;
  border-radius:14px;
  box-shadow:0 3px 10px var(--bubble-shadow);
  margin:16px 0;
}
.reply-box {
  background:#e7fff4;
  border-right:5px solid #10b981;
  padding:12px;
  border-radius:10px;
  margin-top:14px;
}
.wait { color:#777; margin-top:10px; }

.footer-nav {
  text-align:center;
  margin-top:25px;
  font-size:15px;
}
.footer-nav a { color:#2563eb; font-weight:700; text-decoration:none; }
</style>
</head>

<body>

<div class="app-header">ğŸ“¬ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª ÙˆØ§Ù„Ø§Ø³ØªÙØ³Ø§Ø±Ø§Øª</div>

<div class="container">

  <div class="input-card">
    <h3>Ø¥Ø±Ø³Ø§Ù„ Ù…Ù„Ø§Ø­Ø¸Ø© Ø¬Ø¯ÙŠØ¯Ø©</h3>

    <input id="name" placeholder="Ø§Ø³Ù…Ùƒ Ø§Ù„ÙƒØ±ÙŠÙ…">
    <textarea id="message" placeholder="Ø§ÙƒØªØ¨ Ù…Ù„Ø§Ø­Ø¸ØªÙƒâ€¦" rows="4"></textarea>
    <input type="file" id="image">

    <button class="send-btn" onclick="sendNote()">Ø¥Ø±Ø³Ø§Ù„</button>
    <p id="status" style="color:green;"></p>
  </div>

  <h3 style="margin-top:25px;">Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„Ø£Ø®ÙŠØ±Ø©:</h3>
  <div id="notes"></div>

  <div class="footer-nav">
    Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø±Ø¯ÙˆØ¯ â†¦ 
    <a href="admin.html">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</a>
  </div>
</div>

<script>
const scriptURL = "https://script.google.com/macros/s/AKfycbziD6OM8V600UBtuGO-Xx_qRtxcxThRt6KjV2dyYCrET9YSNDreImj91XQfXFNUKDa3/exec";

async function sendNote() {
  const name = name.value.trim();
  const message = message.value.trim();
  const imgFile = document.getElementById("image").files[0];

  if (!name || !message) return status.innerText = "â— Ø£Ø¯Ø®Ù„ Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ù„Ù…Ù„Ø§Ø­Ø¸Ø©";

  status.innerText = "â³ ÙŠØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„â€¦";

  if (imgFile) {
    const r = new FileReader();
    r.onloadend = () => submitNote(name, message, r.result);
    r.readAsDataURL(imgFile);
  } else {
    submitNote(name, message, "");
  }
}

async function submitNote(name, message, image) {
  await fetch(scriptURL, {
    method: "POST",
    body: JSON.stringify({
      type: "note",
      name,
      message,
      image
    })
  });

  status.innerText = "âœ” ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø©!";
  loadNotes();
}

async function loadNotes() {
  const res = await fetch(scriptURL + "?getData");
  const data = await res.json();

  let out = "";
  data.forEach(r => {
    out += `
      <div class="note">
        <b>${r.name}</b>
        <p>${r.message}</p>
        ${r.image ? `<img src="${r.image}" style="width:100%; border-radius:10px; margin-top:12px;">` : ""}
        
        ${
          (r.reply || r.replyImage)
            ? `
              <div class="reply-box">
                ${r.reply ? `<b>Ø±Ø¯ Ø§Ù„Ù…Ø´Ø±Ù:</b> ${r.reply}<br><br>` : ""}
                ${r.replyImage ? `<img src="${r.replyImage}" style="width:100%; border-radius:10px;">` : ""}
              </div>
            `
            : `<div class="wait">â³ Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ø±Ø¯</div>`
        }
      </div>
    `;
  });

  document.getElementById("notes").innerHTML = out;
}

loadNotes();
</script>

</body>
</html>
