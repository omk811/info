<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1, viewport-fit=cover">
  <title>Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© â€“ Ø§Ù„Ø£Ø³ØªØ§Ø° Ø®Ù„ÙŠÙ„ Ø§Ù„Ø¨Ù„ÙˆØ´ÙŠ</title>

  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet">

  <style>
    /* Ù†ÙØ³ ØªØµÙ…ÙŠÙ… Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© 100% */

    :root {
      --primary: #ff4f9a;
      --primary-soft: #ff8a3d;
      --accent: #7c3aed;
      --bg: #050816;
      --card: rgba(15, 23, 42, 0.92);
      --card-soft: rgba(15, 23, 42, 0.85);
      --text: #f9fafb;
      --muted: #9ca3af;
      --radius-lg: 22px;
      --radius-md: 14px;
      --shadow-soft: 0 18px 40px rgba(0,0,0,0.65);
      --glass-border: rgba(148,163,184,0.45);
      --glow: 0 0 25px rgba(236,72,153,0.65);
    }

    * { box-sizing: border-box; margin:0; padding:0; }

    body {
      font-family: "Cairo", sans-serif;
      background:
        radial-gradient(circle at 0% 0%, rgba(236,72,153,0.25), transparent 55%),
        radial-gradient(circle at 100% 0%, rgba(96,165,250,0.24), transparent 55%),
        radial-gradient(circle at 10% 100%, rgba(249,115,22,0.24), transparent 55%),
        #020617;
      color: var(--text);
      line-height: 1.8;
      padding: 20px;
      min-height: 100vh;
    }

    .card {
      background: linear-gradient(135deg, rgba(15,23,42,0.96), rgba(15,23,42,0.9));
      border-radius: var(--radius-lg);
      padding: 20px;
      box-shadow: var(--shadow-soft);
      border: 1px solid var(--glass-border);
      backdrop-filter: blur(16px);
      max-width: 900px;
      margin: 0 auto 20px;
    }

    .title {
      font-size: 22px;
      font-weight: 800;
      margin-bottom: 15px;
      display: flex;
      gap: 8px;
      align-items: center;
    }

    input, textarea {
      width: 100%;
      padding: 12px;
      margin-top: 6px;
      border-radius: var(--radius-md);
      border: 1px solid rgba(148,163,184,0.7);
      background: rgba(15,23,42,0.95);
      color: var(--text);
      font-size: 16px;
    }

    button {
      width: 100%;
      margin-top: 12px;
      padding: 12px;
      border-radius: 999px;
      border: none;
      font-size: 17px;
      font-weight: 700;
      cursor: pointer;
      background-image: linear-gradient(135deg, #f97316, #ec4899, #6366f1);
      color: #fff;
      box-shadow: 0 12px 30px rgba(236,72,153,0.55);
    }

    .note-card {
      background: var(--card-soft);
      padding: 14px;
      border-radius: 18px;
      margin-bottom: 15px;
      border-right: 4px solid rgba(236,72,153,0.9);
    }

    .note-image, .reply-image {
      width: 100%;
      max-height: 260px;
      object-fit: contain;
      border-radius: 14px;
      margin-top: 8px;
      cursor: pointer;
    }

    .modal {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.9);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 200;
    }

    .modal img {
      max-width: 95vw;
      max-height: 90vh;
      border-radius: 20px;
    }

  </style>
</head>

<body>

<!-- Ø´Ø§Ø´Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ -->
<div id="loginCard" class="card">
  <div class="title">ğŸ” ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</div>

  <label>ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
  <input type="password" id="adminPass" placeholder="Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±">

  <button onclick="login()">Ø¯Ø®ÙˆÙ„</button>
  <p id="loginStatus" style="text-align:center;margin-top:10px;color:#fca5a5;"></p>
</div>

<!-- Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… -->
<div id="adminPanel" style="display:none;">

  <div class="card">
    <div class="title">âš™ï¸ Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</div>
    <button onclick="loadNotes()">ğŸ”„ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª</button>
  </div>

  <div id="notesContainer" class="card">
    <div class="title">ğŸ’¬ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª</div>
    <div id="notesList">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>
  </div>
</div>

<!-- Modal -->
<div id="imgModal" class="modal" onclick="hideModal()">
  <img id="modalImg">
</div>

<script>
  const scriptURL = "https://script.google.com/macros/s/AKfycbzVW0bz-FiwR5cDvqx00sXWB9CJjK4zFcMNdLIWPD5Iw4rji1WmAi2yYIF8QdOziDEQ/exec"; // Ø¶Ø¹ Ø±Ø§Ø¨Ø· Ø§Ù„Ø³ÙƒØ±Ø¨Øª Ù‡Ù†Ø§ Ù†ÙØ³ Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯ Ø¨Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©

  function login() {
    const pass = document.getElementById("adminPass").value.trim();

    fetch(scriptURL, {
      method: "POST",
      body: JSON.stringify({
        type: "login",
        password: pass
      })
    })
    .then(res => res.json())
    .then(data => {
      if (data.success) {
        document.getElementById("loginCard").style.display = "none";
        document.getElementById("adminPanel").style.display = "block";
        loadNotes();
      } else {
        document.getElementById("loginStatus").textContent = "âŒ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©";
      }
    })
    .catch(() => {
      document.getElementById("loginStatus").textContent = "âŒ Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø§ØªØµØ§Ù„";
    });
  }

  function loadNotes() {
    const list = document.getElementById("notesList");
    list.innerHTML = "Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...";

    fetch(scriptURL, {
      method: "POST",
      body: JSON.stringify({ type: "get" })
    })
    .then(res => res.json())
    .then(result => {
      if (!result.success) {
        list.textContent = "Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª";
        return;
      }

      let html = "";
      result.data.forEach(n => {
        html += `
          <div class="note-card">
            <p><strong>ğŸ‘¤ ${n.name}</strong></p>
            <p>${n.note}</p>
            ${n.image ? `<img class="note-image" src="${n.image}" onclick="showModal('${n.image}')">` : ""}
            
            <hr style="margin:10px 0;border-color:#555;">

            <label>Ø±Ø¯ Ø§Ù„Ø£Ø³ØªØ§Ø°</label>
            <textarea id="reply_${n.row}">${n.reply || ""}</textarea>

            <label>ØµÙˆØ±Ø© Ø§Ù„Ø±Ø¯</label>
            <input type="file" id="replyImg_${n.row}" accept="image/*">

            <button onclick="saveReply(${n.row})">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ø±Ø¯</button>
          </div>
        `;
      });

      list.innerHTML = html;
    });
  }

  async function saveReply(row) {
    const replyText = document.getElementById(`reply_${row}`).value.trim();
    const fileInput = document.getElementById(`replyImg_${row}`);
    let replyImage = "";

    if (fileInput.files[0]) {
      replyImage = await toBase64(fileInput.files[0]);
    }

    fetch(scriptURL, {
      method: "POST",
      body: JSON.stringify({
        type: "reply",
        row: row,
        reply: replyText,
        replyImage: replyImage
      })
    })
    .then(res => res.json())
    .then(data => {
      alert(data.success ? "âœ” ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø±Ø¯" : "âŒ ÙØ´Ù„ Ø§Ù„Ø­ÙØ¸");
      loadNotes();
    });
  }

  function toBase64(file) {
    return new Promise((resolve) => {
      const reader = new FileReader();
      reader.onload = () => resolve(reader.result);
      reader.readAsDataURL(file);
    });
  }

  function showModal(src) {
    document.getElementById("modalImg").src = src;
    document.getElementById("imgModal").style.display = "flex";
  }

  function hideModal() {
    document.getElementById("imgModal").style.display = "none";
  }
</script>

</body>
</html>
