<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

<title>ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª â€“ Ø§Ù„Ù†Ø³Ø®Ø© 4.0</title>

<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet">

<style>
/* ========== ROOT COLORS ========== */
:root {
    --primary:#4f46e5;
    --secondary:#7c3aed;
    --soft:#eef2ff;
    --card:rgba(255,255,255,0.75);
}

/* ========== BASE ========== */
body {
    font-family:"Cairo",sans-serif;
    margin:0;
    padding-bottom:80px;
    background:linear-gradient(135deg,#e0e7ff,#fdf2f8);
}

.container { width:100%; max-width:620px; margin:auto; padding:15px; }

/* ========== CARD ========== */
.card {
    background:var(--card);
    backdrop-filter:blur(14px);
    padding:20px;
    border-radius:20px;
    box-shadow:0 10px 30px rgba(0,0,0,0.1);
}

/* INPUTS */
input,textarea {
    width:100%;
    padding:14px;
    border-radius:14px;
    border:none;
    margin:10px 0;
    background:#f1f5f9;
    font-size:16px;
    box-sizing:border-box;
}

/* BUTTON */
.btn {
    width:100%;
    padding:14px;
    background:linear-gradient(135deg,var(--primary),var(--secondary));
    color:white;
    border:none;
    border-radius:14px;
    font-size:18px;
}

/* NOTES */
.note {
    background:white;
    padding:16px;
    border-radius:14px;
    margin:14px 0;
    border-right:6px solid var(--primary);
    box-shadow:0 6px 14px rgba(0,0,0,0.08);
}

.note img {
    width:100%;
    border-radius:10px;
    margin-top:10px;
    cursor:pointer;
}

/* ========== IMAGE MODAL ========== */
#imgModal {
    position:fixed; 
    top:0; left:0;
    width:100%; height:100%;
    background:rgba(0,0,0,0.9);
    display:none;
    align-items:center;
    justify-content:center;
    z-index:5000;
}
#imgModal img {
    max-width:95%; 
    max-height:95%; 
    border-radius:14px;
}

/* ========== BOTTOM NAVIGATION ========== */
.bottom-nav {
    position:fixed;
    bottom:0; left:0;
    width:100%;
    background:white;
    display:flex;
    justify-content:space-around;
    padding:10px 0;
    box-shadow:0 -5px 12px rgba(0,0,0,0.15);
    z-index:3000;
}
.bottom-nav a {
    text-decoration:none;
    color:#475569;
    font-size:14px;
    text-align:center;
}

/* RESPONSIVE */
@media(max-width:500px){
    h1 { font-size:22px; }
    .card { padding:14px; }
    .note { padding:12px; }
}
</style>
</head>

<body>

<div class="container">

<h1 style="text-align:center;color:var(--primary);">ğŸ“® ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª</h1>

<!-- ========== SEND BOX ========== -->
<div class="card">
    <input id="name" placeholder="Ø§Ø³Ù…Ùƒ Ø§Ù„ÙƒØ±ÙŠÙ…">
    <textarea id="note" rows="4" placeholder="Ø§ÙƒØªØ¨ Ù…Ù„Ø§Ø­Ø¸ØªÙƒ..."></textarea>
    <input type="file" id="image">

    <button class="btn" onclick="sendNote()">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø©</button>
</div>

<h2 style="margin-top:30px;color:#334155;">ğŸ’¬ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„Ù…Ø±Ø¯ÙˆØ¯ Ø¹Ù„ÙŠÙ‡Ø§</h2>
<div id="replies"></div>

</div>

<!-- ========== BOTTOM NAVIGATION ========== -->
<div class="bottom-nav">
    <a href="#top">ğŸ  Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
    <a href="#form">ğŸ“ Ø¥Ø±Ø³Ø§Ù„</a>
    <a href="#replies">ğŸ’¬ Ø§Ù„Ø±Ø¯ÙˆØ¯</a>
    <a href="admin.html">âš™ï¸ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</a>
</div>

<!-- ========== IMAGE MODAL ========== -->
<div id="imgModal" onclick="this.style.display='none'">
    <img id="modalImg">
</div>

<script>
const scriptURL = "https://script.google.com/macros/s/AKfycbzI1WkE0fUr6HaYiNMBiDn9JfTIByXjCvjQ6jnTyasz5Asyn0mLX4dNrcLVFADVHKMr/exec";

/* CONVERT IMAGE TO BASE64 */
function toBase64(file){
    return new Promise(res=>{
        let r=new FileReader();
        r.onload=()=>res(r.result);
        r.readAsDataURL(file);
    });
}

/* SEND NOTE */
async function sendNote(){
    let name=document.getElementById("name").value.trim();
    let note=document.getElementById("note").value.trim();
    let file=document.getElementById("image").files[0];

    let img="";
    if(file) img=await toBase64(file);

    await fetch(scriptURL,{
        method:"POST",
        body:JSON.stringify({type:"add",name,note,image:img})
    });

    loadReplies();
}

/* LOAD REPLIES */
async function loadReplies(){
    let r=await fetch(scriptURL,{method:"POST",body:JSON.stringify({type:"get"})});
    let data=await r.json();

    let box=document.getElementById("replies");
    box.innerHTML="";

    data.data.filter(n=>n.reply).forEach(n=>{
        box.innerHTML+=`
            <div class="note">
                <strong>ğŸ‘¤ ${n.name}</strong><br>
                ${n.note.replace(/\n/g,"<br>")}
                ${n.image?`<img src="${n.image}" onclick="showImg('${n.image}')">`:''}

                <div style="margin-top:10px;color:#16a34a;">
                    âœ” Ø±Ø¯ Ø§Ù„Ø£Ø³ØªØ§Ø°:<br>${n.reply.replace(/\n/g,"<br>")}
                </div>

                ${n.replyImage?`<img src="${n.replyImage}" onclick="showImg('${n.replyImage}')">`:''}
            </div>
        `;
    });
}

function showImg(src){
    document.getElementById("modalImg").src=src;
    document.getElementById("imgModal").style.display="flex";
}

loadReplies();
</script>

</body>
</html>
