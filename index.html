<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, viewport-fit=cover" />
  <title>ØµÙ†Ø¯ÙˆÙ‚ Ù…Ù„Ø§Ø­Ø¸Ø§Øª â€“ Ø§Ù„Ø£Ø³ØªØ§Ø° Ø®Ù„ÙŠÙ„ Ø§Ù„Ø¨Ù„ÙˆØ´ÙŠ</title>

  <!-- Fonts & Icons -->
  <link href="https://fonts.googleapis.com/css2?family=Baloo+Bhaijaan+2:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <style>
    :root {
      --primary: #3b82f6;
      --secondary: #8b5cf6;
      --accent: #f59e0b;
      --bg-dark: #0f172a;
      --card-bg: rgba(30, 41, 59, 0.7);
      --text-main: #f8fafc;
      --text-dim: #94a3b8;
      --success: #10b981;
      --border-color: rgba(255, 255, 255, 0.1);
      --radius: 20px;
      --shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      transition: all 0.3s ease;
    }

    body {
      font-family: "Baloo Bhaijaan 2", sans-serif;
      background: radial-gradient(circle at top left, #1e293b, #0f172a);
      color: var(--text-main);
      min-height: 100vh;
      padding-bottom: 110px;
    }

    .container {
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
    }

    .hero-section {
      text-align: center;
      padding: 30px 20px;
      background: linear-gradient(135deg, rgba(59,130,246,.15), rgba(139,92,246,.15));
      border-radius: var(--radius);
      margin-bottom: 25px;
      border: 1px solid var(--border-color);
      box-shadow: var(--shadow);
    }

    .hero-section h1 {
      font-size: 1.8rem;
      margin-bottom: 8px;
    }

    .hero-section p {
      color: var(--text-dim);
      font-size: 1.05rem;
    }

    .glass-card {
      background: var(--card-bg);
      backdrop-filter: blur(12px);
      border-radius: var(--radius);
      padding: 25px;
      border: 1px solid var(--border-color);
      margin-bottom: 25px;
      box-shadow: var(--shadow);
    }

    .section-title {
      color: var(--accent);
      font-size: 1.25rem;
      margin-bottom: 15px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    input, textarea {
      width: 100%;
      padding: 12px;
      margin-top: 8px;
      border-radius: 12px;
      background: rgba(15, 23, 42, 0.6);
      border: 1px solid var(--border-color);
      color: #fff;
      font-family: inherit;
    }

    textarea { min-height: 120px; resize: vertical; }

    .btn-primary {
      width: 100%;
      padding: 15px;
      border-radius: 12px;
      border: none;
      background: linear-gradient(90deg, var(--primary), var(--secondary));
      color: #fff;
      font-weight: 700;
      margin-top: 15px;
      cursor: pointer;
    }

    .btn-primary:hover { transform: translateY(-2px); }

    .btn-refresh {
      background: transparent;
      border: 1px solid var(--primary);
      color: var(--primary);
      padding: 8px 15px;
      border-radius: 8px;
      cursor: pointer;
      font-size: .9rem;
    }

    .note-item {
      background: rgba(255,255,255,.04);
      border-radius: 15px;
      padding: 18px;
      margin-bottom: 15px;
      border-right: 4px solid var(--accent);
    }

    .teacher-reply {
      background: rgba(16,185,129,.1);
      border-radius: 10px;
      padding: 15px;
      margin-top: 15px;
      border: 1px solid rgba(16,185,129,.25);
    }

    .bottom-nav {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: rgba(15,23,42,.95);
      display: flex;
      justify-content: space-around;
      padding: 12px 5px;
      border-top: 1px solid var(--border-color);
      z-index: 2000;
    }

    .nav-item {
      text-decoration: none;
      color: var(--text-dim);
      font-size: .8rem;
      text-align: center;
      flex: 1;
    }

    .nav-item i {
      font-size: 1.4rem;
      display: block;
      margin-bottom: 4px;
    }

    .nav-item.active { color: var(--primary); }
    .nav-item.admin-link { color: #f87171; }

    /* ================= POPUP ================= */
    .popup-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,.9);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 5000;
      padding: 15px;
    }

    .popup-card {
      background: linear-gradient(135deg,#0f172a,#1e293b);
      border-radius: 20px;
      padding: 26px 22px;
      max-width: 380px;
      width: 100%;
      text-align: center;
      border: 1px solid rgba(255,255,255,.1);
      box-shadow: 0 20px 40px rgba(0,0,0,.45);
      animation: scaleIn .4s ease;
    }

    @keyframes scaleIn {
      from { transform: scale(.85); opacity: 0; }
      to { transform: scale(1); opacity: 1; }
    }

    .popup-close {
      position: absolute;
      top: 12px;
      left: 15px;
      background: none;
      border: none;
      color: #94a3b8;
      font-size: 26px;
      cursor: pointer;
    }

    .popup-card i {
      font-size: 3rem;
      color: var(--accent);
      margin-bottom: 10px;
    }

    .popup-card h2 {
      font-size: 1.4rem;
      margin-bottom: 10px;
    }

    .popup-card p {
      color: #cbd5f5;
      line-height: 1.7;
      margin-bottom: 20px;
    }

    .popup-btn {
      display: block;
      background: linear-gradient(90deg,var(--primary),var(--secondary));
      color: #fff;
      padding: 14px;
      border-radius: 14px;
      font-weight: 700;
      text-decoration: none;
    }
  </style>
</head>

<body>

<!-- ================= POPUP ================= -->
<div id="lessonsPopup" class="popup-overlay">
  <div class="popup-card">
    <button class="popup-close" onclick="closePopup()">Ã—</button>
    <i class="fas fa-graduation-cap"></i>
    <h2>Ø§Ù„Ø¯Ø±ÙˆØ³ ÙˆØ§Ù„ØªØ¯Ø±ÙŠØ¨Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©</h2>
    <p>
      ØµÙØ­Ø© Ø®Ø§ØµØ© ØªØ¶Ù… Ø£Ø­Ø¯Ø«<br>
      <strong>Ø§Ù„Ø¯Ø±ÙˆØ³ØŒ Ø§Ù„ØªØ¯Ø±ÙŠØ¨Ø§ØªØŒ ÙˆØ§Ù„Ø£Ù†Ø´Ø·Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©</strong><br>
      Ø¨Ø¥Ø´Ø±Ø§Ù Ø§Ù„Ø£Ø³ØªØ§Ø° Ø®Ù„ÙŠÙ„ Ø§Ù„Ø¨Ù„ÙˆØ´ÙŠ
    </p>
    <a href="https://omk811.github.io/info/index.html" target="_blank" class="popup-btn" onclick="markPopupSeen()">
      Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„ØµÙØ­Ø© Ø§Ù„Ø¢Ù† ğŸš€
    </a>
  </div>
</div>

<div class="container">
  <header class="hero-section">
    <h1><i class="fas fa-inbox"></i> ØµÙ†Ø¯ÙˆÙ‚ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„ØµÙ Ø§Ù„Ø®Ø§Ù…Ø³</h1>
    <p>Ø¨Ø¥Ø´Ø±Ø§Ù <strong>Ø§Ù„Ø£Ø³ØªØ§Ø° Ø®Ù„ÙŠÙ„ Ø§Ù„Ø¨Ù„ÙˆØ´ÙŠ</strong></p>
  </header>

  <div class="glass-card">
    <h2 class="section-title"><i class="fas fa-pen"></i> Ø¥Ø±Ø³Ø§Ù„ Ù…Ù„Ø§Ø­Ø¸Ø©</h2>
    <input id="name" placeholder="Ø§Ù„Ø§Ø³Ù… (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)">
    <textarea id="note" placeholder="Ø§ÙƒØªØ¨ Ù…Ù„Ø§Ø­Ø¸ØªÙƒ Ù‡Ù†Ø§..."></textarea>
    <button class="btn-primary" onclick="sendNote()">Ø¥Ø±Ø³Ø§Ù„</button>
    <p id="formStatus" style="text-align:center;margin-top:8px;"></p>
  </div>

  <div class="glass-card">
    <div style="display:flex;justify-content:space-between;align-items:center;">
      <h2 class="section-title"><i class="fas fa-comment"></i> Ø§Ù„Ø±Ø¯ÙˆØ¯</h2>
      <button class="btn-refresh" onclick="loadReplies()">ØªØ­Ø¯ÙŠØ«</button>
    </div>
    <div id="replies"></div>
  </div>
</div>

<nav class="bottom-nav">
  <a href="#" class="nav-item active"><i class="fas fa-home"></i>Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
  <a href="#send" class="nav-item"><i class="fas fa-plus-circle"></i>Ø¥Ø±Ø³Ø§Ù„</a>
  <a href="admin.html" class="nav-item admin-link"><i class="fas fa-user-cog"></i>Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</a>
</nav>

<script>
  const scriptURL = "https://script.google.com/macros/s/AKfycbw1qGg0ZASORdCNI7YjiHkB0fS04tFG_BOfgu1O7kjKC2I4PDws6kmFC6LAGr83XRBB/exec";
  const POPUP_KEY = "lessons_popup_seen";

  function showPopup() {
    if (!localStorage.getItem(POPUP_KEY)) {
      document.getElementById("lessonsPopup").style.display = "flex";
    }
  }

  function closePopup() {
    document.getElementById("lessonsPopup").style.display = "none";
    localStorage.setItem(POPUP_KEY, "true");
  }

  function markPopupSeen() {
    localStorage.setItem(POPUP_KEY, "true");
  }

  async function sendNote() {
    const note = document.getElementById("note").value.trim();
    const name = document.getElementById("name").value || "Ù…Ø¬Ù‡ÙˆÙ„";
    const status = document.getElementById("formStatus");

    if (!note) {
      status.textContent = "ÙŠØ±Ø¬Ù‰ ÙƒØªØ§Ø¨Ø© Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø©";
      return;
    }

    status.textContent = "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„...";
    await fetch(scriptURL, {
      method: "POST",
      body: JSON.stringify({ type: "add", name, note })
    });

    status.textContent = "ØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø¨Ù†Ø¬Ø§Ø­";
    document.getElementById("note").value = "";
    loadReplies();
  }

  async function loadReplies() {
    const r = await fetch(scriptURL, { method: "POST", body: JSON.stringify({ type: "get" }) });
    const data = await r.json();
    document.getElementById("replies").innerHTML =
      data.data.filter(n => n.reply).map(n =>
        `<div class="note-item">
          <strong>${n.name}</strong>
          <p>${n.note}</p>
          <div class="teacher-reply">${n.reply}</div>
        </div>`
      ).join("") || "Ù„Ø§ ØªÙˆØ¬Ø¯ Ø±Ø¯ÙˆØ¯";
  }

  setTimeout(showPopup, 1500);
  loadReplies();
</script>

</body>
</html>
